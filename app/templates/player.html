<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="http://aishek.github.io/jquery-animateNumber/javascripts/jquery.animateNumber.js"></script>
<script src="http://jschr.github.io/textillate/assets/jquery.fittext.js"></script>
<script src="http://jschr.github.io/textillate/assets/jquery.lettering.js"></script>
<script src="http://jschr.github.io/textillate/jquery.textillate.js"></script>
<script>
  var socket = io.connect();
  socket.on('players', function (data) {
    if('{{position}}' in data){
        var player = data[{{position}}];

        if(player.name != $('#playerName').text()){
          $('#playerName').fadeOut(function(){
            $('#playerName')
              .text(player.name)
              .fadeIn();
          })
        }

        $('#lifeTotal').animateNumber({
          number: player.life,
        }).prop('number', player.life);

        if(player.commander != $('#commanderName').text()){
          $('#colorWheel > img').fadeOut();
          $('#commanderName')
            .fadeOut(function(){
              $('#commanderName').text(player.commander).fadeIn();
              $('#colorWheel > img')
                .attr('src', '/static/mana/' + player.commanderInfo.manaIcon)
                .fadeIn();
            });
        }

        if(!$('#card').is(':visible')){
            $('#card').fadeIn();
        }
    } else {
      console.log('Position not found, hiding card!');
      if($('#card').is(':visible')){
          $('#card').fadeOut();
      }
    }
  });
</script>
<link href='http://fonts.googleapis.com/css?family=Josefin+Sans:700italic' rel='stylesheet' type='text/css'>
<style>
body, td{ font-family: 'Josefin Sans', sans-serif; color: white;}
#playerName{  font-size: 16px; }
#commanderName{ font-size: 12px; text-transform: capitalize;}
#lifeTotal{ font-size: 30px; text-align: right; padding-right: 10px; }
#colorWheel{ width: 50px;}
#card{
     border-radius: 90px 90px 90px 90px;
     -moz-border-radius: 90px 90px 90px 90px;
     -webkit-border-radius: 90px 90px 90px 90px;
     background:black;
}
</style>
<table width="400" id="card">
    <tr>
        <td id="colorWheel" rowspan="2">
            <img height="40" src="/static/mana/{{commanderInfo.manaIcon|default('none.png')}}" />
        </td>
        <td>
          <span id="playerName">{{name}}</span>&nbsp;
        </td>
        <td id="lifeTotal" rowspan="2">{{life}}</td>
    </tr>
    <tr>
        <td>
          <span id="commanderName">{{commander}}</span>&nbsp;
        </td>
    </tr>
</table>
<script>
$(document).ready(function(){
  {% if blank %}
  $('#card').fadeOut();
  {% endif %}
  $('#lifeTotal').prop('number', {{life}});
});
</script>